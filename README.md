# 🛡️ Phishing Link Detection System (IoT Threat & Anomaly Detection)

This project develops a **machine learning–powered phishing URL detector** designed for **real-time cyber-threat analysis** across IoT and enterprise environments.  
It combines lexical and structural URL feature extraction with **Random Forest classification** served through a **Flask API**, containerized with **Docker**, and deployed to **Google Cloud Run** with a **Dialogflow chatbot interface**.

---

## 🚀 Overview

- **Goal:** Identify malicious URLs and phishing attempts using interpretable ML features.
- **Core Stack:** Python · scikit-learn · Flask · Docker · Google Cloud Run · Dialogflow
- **Model:** Random Forest classifier (`phishing_url_classifier.pkl`)
- **Detection Accuracy:** ~85.9% on held-out test data
- **Use Case:** Real-time phishing prevention for IoT devices, browsers, or enterprise SOCs.

---

## 🧠 Key Features

- **URL Risk Scoring:** Detects and classifies URLs as *phishing* or *safe* based on engineered lexical and structural indicators.  
- **Feature Engineering:** Extracts over **30 URL-level attributes** (length, digits, TLDs, redirections, keyword flags, etc.).
- **Flask Webhook API:** Exposes a `/webhook` endpoint that returns human-readable risk assessments.
- **Containerization & Cloud Deployment:** Built with Docker and deployed to **Google Cloud Run**, enabling auto-scaling and integration with **Dialogflow** for conversational phishing detection.
- **End-to-End ML Lifecycle:** From data processing → model training → deployment → chatbot interaction.

---

## 📦 Dataset

This project uses the **[Phishing Site URLs Dataset](https://www.kaggle.com/datasets/taruntiwarihp/phishing-site-urls)** from Kaggle.  

The dataset contains **~549,000 URLs** labeled as *phishing* or *legitimate*, with domain-level and structural features ideal for supervised machine learning.  

Example code to load the dataset:
```python
import pandas as pd
df = pd.read_csv("phishing_site_urls.csv")
df.head()

## 🧩 Model & Features

### **Algorithm**
- **Random Forest** classifier trained with `scikit-learn`
- Serialized artifact: `phishing_url_classifier.pkl`

### **Engineered Features**

| Feature Type | Examples |
|---------------|-----------|
| **Structural** | `URL_length`, `Number_of_dots`, `Number_of_slashes`, `Percentage_of_digits` |
| **Lexical** | `Suspicious_keywords`, `Dangerous_TLD`, `Repetitions` |
| **Behavioral** | `Has_IP_Address`, `Contains_redirect`, `Encoded_characters` |

All features are generated by `extract_url_features(url)` within the Flask app.

---

## 🖥️ API Reference

### **Endpoint**
```
POST /webhook
Content-Type: application/json
```

### **Request Example**
```json
{
  "queryResult": {
    "parameters": {
      "url": "http://login.example-secure-update.com/account/verify"
    }
  }
}
```

### **Response Example**

**High Risk**
```json
{
  "fulfillmentText": "🚨 HIGH RISK: http://... is likely a phishing site! The URL contains dangerous characters and suspicious keywords."
}
```

**Low Risk**
```json
{
  "fulfillmentText": "✅ LOW RISK: http://... appears safe."
}
```

---

## 🛠️ Local Setup

### **1️⃣ Environment Setup**
```bash
python -m venv .venv
source .venv/bin/activate    # On Windows: .venv\Scriptsctivate
pip install -r requirements.txt
```

### **2️⃣ Place Model Artifact**
Ensure `phishing_url_classifier.pkl` exists in the project root:
```
./phishing_url_classifier.pkl
```

### **3️⃣ Run Locally**
```bash
export PORT=8080
python app.py
```
Access locally at [http://0.0.0.0:8080/webhook](http://0.0.0.0:8080/webhook).

---

## 🐳 Docker Deployment

### **Build & Run Locally**
```bash
docker build -t phishing-detector:latest .
docker run -p 8080:8080 phishing-detector:latest
```

### **Deploy to Google Cloud Run**

1. Push image to **Google Artifact Registry**.
2. Deploy with:
   ```bash
   gcloud run deploy phishing-detector        --image gcr.io/YOUR_PROJECT_ID/phishing-detector:latest        --platform managed        --allow-unauthenticated
   ```
3. Copy the deployed URL and configure it as your **Dialogflow webhook**.

---

## ☁️ GCP + Dialogflow Integration

1. **Containerize & Push** your app using Docker.  
2. **Deploy to Cloud Run** (auto-scaling, HTTPS endpoint).  
3. **Connect Dialogflow:**  
   - Create a new Dialogflow agent.  
   - Set the webhook URL to your Cloud Run endpoint.  
   - Add an intent with parameter `url` that triggers the webhook.  
4. **Test conversational predictions** directly in Dialogflow’s console or chat UI.

> The deployment steps and webhook integration are demonstrated in the **[Full Demo Video](https://drive.google.com/file/d/1hdVDIJqGNN0IDaWyhlG5K_5_ErUSfq9Y/view?usp=sharing)**.

---

## 🎥 Project Videos

### **▶️ Full Demo**
[Watch on Google Drive](https://drive.google.com/file/d/1hdVDIJqGNN0IDaWyhlG5K_5_ErUSfq9Y/view?usp=sharing)

### **🎙️ Elevator Pitch**
[Watch on Google Drive](https://drive.google.com/file/d/1lYHuwEWI9-k5JYCLpECVplCJruVBDHFt/view?usp=sharing)

---

## 🔐 Security Considerations

- Sanitizes and validates all URL inputs before analysis.  
- Avoids persistent logging of raw URLs for privacy.  
- Model predictions are deterministic; no black-box web lookups.  
- Recommended: add **rate-limiting** and **API key authentication** for production use.  

---

## 🗂️ Repository Structure
```
.
├── app.py                       # Flask API for phishing detection
├── phishing_url_classifier.pkl   # Trained Random Forest model
├── requirements.txt
├── Dockerfile
├── notebooks/                    # Jupyter notebooks for model training
├── sample_data.csv               # Small, safe example dataset
├── demo/                         # Demo video or screenshots
└── README.md
```

---

## 📊 Results Summary

| Metric     | Value |
|------------|-------|
| Accuracy   | 85.94% |
| Precision  | 0.87 |
| Recall     | 0.84 |
| F1-Score   | 0.85 |

*Future enhancements include ensemble and transformer architectures, live threat feeds, and integration with SOC dashboards.*

---

## 🧭 Roadmap

- [ ] Add Autoencoder/Transformer baselines for anomaly detection  
- [ ] Integrate real-time phishing feeds for online learning  
- [ ] Add browser/email extensions  
- [ ] Implement multilingual Dialogflow responses  

---

## 👩‍💻 Authors

**Kimberley Maldonado**  
Brendan Kenny · Brianna Cirillo · Emily Su  
*Stevens Institute of Technology — BIA662 Applied Machine Learning*

---

## 📄 License

MIT License © 2025 Kimberley Maldonado

---

## 🌐 Connect

- **GitHub:** https://github.com/kmaldonado1  
- **LinkedIn:** https://linkedin.com/in/kimberleymaldonado

> *"Secure the web, one URL at a time."*
